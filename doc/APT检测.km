{"root":{"data":{"id":"a0c59ddab7c9","created":1506474349,"text":"APT检测","note":"都看作文件？？？\n\n继承自文件 ？？？\n\n所以每个文件都要有实现基础方法的接口：\nssdeep验证和yara命中,异常检测模型\n\n而且每个都要有时间戳\n\n\n有无和是否文字均对应方法\n\n经验主义规则如何通过读取配置文件作为一种策略实现\n\n\n主程序入口：\n匹配规则文件，所有输出以布尔值论处\n"},"children":[{"data":{"id":"bg1cloi93jeo","created":1506474389575,"text":"进程","layout_mind_offset":{"x":-529,"y":302}},"children":[{"data":{"id":"bg1cm51h38jk","created":1506474425566,"text":"进程ID"},"children":[]},{"data":{"id":"bg1d5ooz9728","created":1506475957265,"text":"父进程"},"children":[]},{"data":{"id":"bg1d5qxnoyyo","created":1506475962143,"text":"子进程"},"children":[]},{"data":{"id":"bg1egp5qrbb4","created":1506479641394,"text":"有无权限提升现象"},"children":[]},{"data":{"id":"bg1drr2zyxa8","created":1506477686478,"text":"文件溯源"},"children":[]},{"data":{"id":"bg1d5u3u0agw","created":1506475969047,"text":"所属用户"},"children":[]},{"data":{"id":"bg1d61kpcow0","created":1506475985305,"text":"所属用户组"},"children":[]},{"data":{"id":"bg1d5x6zqlmo","created":1506475975768,"text":"由谁启动"},"children":[{"data":{"id":"bg1d6f2pamf4","created":1506476014691,"text":"某个进程"},"children":[]},{"data":{"id":"bg1d6h9x5r0g","created":1506476019481,"text":"某个用户"},"children":[]}]},{"data":{"id":"bg1efbw9cni8","created":1506479534159,"text":"内存起始地址"},"children":[]},{"data":{"id":"bg1efe5cb668","created":1506479539061,"text":"内存结束地址"},"children":[]},{"data":{"id":"bg1dl2me55a8","created":1506477163046,"text":"是否处在危险内存区"},"children":[]},{"data":{"id":"bg1dk5lnfp4w","created":1506477091167,"text":"I/O行为"},"children":[]},{"data":{"id":"bg1dk99f3sw0","created":1506477099135,"text":"前后的网络行为对比"},"children":[]},{"data":{"id":"bg1dl96dy2v4","created":1506477177316,"text":"前后的CPU占用对比","note":"占用对比均以比率表示"},"children":[]},{"data":{"id":"bg1dpwjos45c","created":1506477541643,"text":"前后内存占用对比"},"children":[]},{"data":{"id":"bg1dkc1312ww","created":1506477105161,"text":"起始时间"},"children":[]},{"data":{"id":"bg1dkpdafh1c","created":1506477134197,"text":"结束时间"},"children":[]}]},{"data":{"id":"bg1clpijtiww","created":1506474391770,"text":"文件"},"children":[{"data":{"id":"bg1crfiw2bk0","created":1506474840207,"text":"普通文件","layout_right_offset":{"x":0,"y":-42}},"children":[{"data":{"id":"bg1crqh9eolc","created":1506474864054,"text":"大小"},"children":[]},{"data":{"id":"bg1crumsjnr4","created":1506474873095,"text":"类型"},"children":[]},{"data":{"id":"bg1crvqn4cn4","created":1506474875505,"text":"后缀"},"children":[]},{"data":{"id":"bg1crxh3twxs","created":1506474879282,"text":"权限"},"children":[]},{"data":{"id":"bg1cs04zgq9s","created":1506474885079,"text":"所属用户"},"children":[]},{"data":{"id":"bg1cs2buiu4g","created":1506474889848,"text":"文件路径"},"children":[]},{"data":{"id":"bg1cs8q98uf4","created":1506474903780,"text":"md5/sha1值"},"children":[]},{"data":{"id":"bg1cscubbh1c","created":1506474912732,"text":"模糊HASH值"},"children":[]},{"data":{"id":"bg1csjl748w0","created":1506474927418,"text":"该文件头字节段，尾字节段，摘要字节段","note":"用来判断是否在该类型下\n同样的\n后缀和该文件类型是否一致\n"},"children":[]},{"data":{"id":"bg1dviz4yj28","created":1506477982287,"text":"信息论和统计上的方法"},"children":[{"data":{"id":"bg1dwlrpay9s","created":1506478066732,"text":"信息熵"},"children":[]},{"data":{"id":"bg1dwop3uk1s","created":1506478073105,"text":"文件内重合指数"},"children":[]},{"data":{"id":"bg1dx7lvcfeo","created":1506478114268,"text":"文本内容是否有意义","note":"此处可设计一个seq2seq的模型:\n\n例如：\n\n所有的不同语言的对应上传函数\n对应执行系统命令的函数\n\n把逻辑翻译出来\n\n\n例如：我上传文件没有安全编码并想执行他还想进行网络连接\n\n\n可靠指数: 2.5颗星星\n"},"children":[]}]},{"data":{"id":"bg1csoxswpa8","created":1506474939064,"text":"是否被yara命中"},"children":[]},{"data":{"id":"bg1dulgcsbnk","created":1506477909317,"text":"是否鹤立鸡群，稍显怪异","note":"采用贝叶斯之类的算法，计算比较和当前文件下的文件的差异性\n"},"children":[]},{"data":{"id":"bg1cwvvi7n5s","created":1506475267620,"text":"文件操作的时间戳(创建时间/修改时间/删除时间/）"},"children":[]}]},{"data":{"id":"bg1criaj2o00","created":1506474846232,"text":"可执行文件","note":"dll \nexe\nps \nvbs\n\n各种脚本"},"children":[{"data":{"id":"bg1d4irgtzi8","created":1506475865991,"text":"执行时的内存中地址范围"},"children":[]},{"data":{"id":"bg1d5ataclj4","created":1506475927050,"text":"对应到哪个进程"},"children":[]},{"data":{"id":"bg1ee9jgsq2o","created":1506479450667,"text":"反编译得到的raw文件以securename存储","note":"raw文件被命中，则可执行文件被命中，则进程被命中\n"},"children":[]}]},{"data":{"id":"bg1cvmbaq8zk","created":1506475168442,"text":"注册表"},"children":[]},{"data":{"id":"bg1d2rvh2dq8","created":1506475729095,"text":"常用的文档","layout_right_offset":{"x":-2,"y":18}},"children":[{"data":{"id":"bg1d338keubk","created":1506475753832,"text":"office那一套"},"children":[]},{"data":{"id":"bg1d3e4qyha8","created":1506475777546,"text":"pdf感染检测"},"children":[]}]}]},{"data":{"id":"bg1clq6ba03k","created":1506474393207,"text":"各种日志","layout_mind_offset":{"x":914,"y":74},"note":"这一块完全可以不用手动收集，当然一定会用到正则匹配"},"children":[{"data":{"id":"bg1cu7k9d1c0","created":1506475057968,"text":"命令行历史","layout_right_offset":{"x":300,"y":26}},"children":[]},{"data":{"id":"bg1cu9nncjcw","created":1506475062527,"text":"文件操作删除历史","layout_right_offset":{"x":276,"y":29}},"children":[]},{"data":{"id":"bg1cue4hlt6o","created":1506475072252,"text":"系统日志","layout_right_offset":{"x":307,"y":22}},"children":[{"data":{"id":"bg1dtpt08tfk","created":1506477840425,"text":"前后用户有无变化"},"children":[]},{"data":{"id":"bg1dts7hvzeo","created":1506477845655,"text":"分支主题"},"children":[]}]},{"data":{"id":"bg1cuiorvgu8","created":1506475082186,"text":"网络访问日志","layout_right_offset":{"x":294,"y":21}},"children":[]},{"data":{"id":"bg1cupoed6v4","created":1506475097401,"text":"防火墙日志","layout_right_offset":{"x":-336,"y":-13}},"children":[]},{"data":{"id":"bg1curlipq80","created":1506475101581,"text":"杀毒软件日志历史","layout_right_offset":{"x":-370,"y":-14}},"children":[]},{"data":{"id":"bg1cv3znwx6o","created":1506475128557,"text":"注册表修改日志","layout_right_offset":{"x":-370,"y":-14}},"children":[]},{"data":{"id":"bg1cvj7izaio","created":1506475161684,"text":"环境变量修改历史","layout_right_offset":{"x":-16,"y":337}},"children":[]},{"data":{"id":"bg1d0ocbyyv4","created":1506475564679,"text":"数据库日志"},"children":[]},{"data":{"id":"bg1d0qpcoi68","created":1506475569820,"text":"web服务器日志"},"children":[]},{"data":{"id":"bg1ej98kt3wg","created":1506479841830,"text":"邮件服务器日志"},"children":[]},{"data":{"id":"bg1d3ju4uvpc","created":1506475789964,"text":"浏览器日志","note":"很重要的一套东西\n\n"},"children":[{"data":{"id":"bg1eijqmt05c","created":1506479786325,"text":"访问历史"},"children":[{"data":{"id":"bg1ekueyqt4w","created":1506479966292,"text":"是否在黑白名单"},"children":[]}]},{"data":{"id":"bg1eilpk5czk","created":1506479790614,"text":"加载的js列表","note":"对应js包含的是否有攻击向量\nxss检测等\n"},"children":[]},{"data":{"id":"bg1eisillg5c","created":1506479805430,"text":"对应js的行为 "},"children":[]}]},{"data":{"id":"bg1dctl58f7k","created":1506476516466,"text":"常用软件日志","layout_right_offset":{"x":-254,"y":-682.9999847412109}},"children":[{"data":{"id":"bg1dd8eo0rgg","created":1506476548726,"text":"管家类"},"children":[]},{"data":{"id":"bg1ddcme0jy8","created":1506476557900,"text":"驱动类"},"children":[]},{"data":{"id":"bg1dddtrm4g0","created":1506476560523,"text":"社交类"},"children":[]},{"data":{"id":"bg1ddk0bd9fk","created":1506476573980,"text":"游戏类"},"children":[]},{"data":{"id":"bg1ddkzdda0w","created":1506476576099,"text":"补丁，破解"},"children":[]},{"data":{"id":"bg1ddpb674sg","created":1506476585520,"text":"分支主题"},"children":[]}]}]},{"data":{"id":"bg1clqjpcdfk","created":1506474394016,"text":"网络","note":"* In And Out\nDNS\nTCP/IP\nHTTP\nSMTP\nPING\nSSH\n\n针对不同协议要添加不同的属性\n\n* transfer data\n* exhaused time\n","layout_mind_offset":{"x":-218,"y":90}},"children":[{"data":{"id":"bg1cp7c4mhhc","created":1506474665656,"text":"是否发生磁盘读写"},"children":[]},{"data":{"id":"bg1dnq1wv668","created":1506477370779,"text":"上传速度"},"children":[]},{"data":{"id":"bg1dnu04ppmo","created":1506477379378,"text":"下载速度"},"children":[]},{"data":{"id":"bg1dnw3tx6gw","created":1506477383955,"text":"起始时间"},"children":[]},{"data":{"id":"bg1dopkpzocg","created":1506477448103,"text":"结束时间"},"children":[]},{"data":{"id":"bg1doczv720w","created":1506477420721,"text":"采用协议"},"children":[]},{"data":{"id":"bg1e3o921csg","created":1506478620684,"text":"采用的端口"},"children":[]},{"data":{"id":"bg1e10pi7zls","created":1506478412707,"text":"出度的目的IP","layout_left_offset":{"x":10,"y":146}},"children":[]},{"data":{"id":"bg1e0y1nrpxc","created":1506478406912,"text":"入度的源IP"},"children":[{"data":{"id":"bg1e2htf2y9s","created":1506478528313,"text":"是否在黑白名单之中"},"children":[]},{"data":{"id":"bg1e2nfvj5kw","created":1506478540556,"text":"是否需要采用nmap进行探测?"},"children":[{"data":{"id":"bg1e3z1dzi80","created":1506478644165,"text":"操作系统版本"},"children":[]},{"data":{"id":"bg1e40pyl2ww","created":1506478647827,"text":"端口"},"children":[]},{"data":{"id":"bg1e41yhnbpc","created":1506478650520,"text":"托管服务及ip"},"children":[]}]}]},{"data":{"id":"bg1e1ckj4phc","created":1506478438528,"text":"携带的数据摘取"},"children":[{"data":{"id":"bg1eb3nianeo","created":1506479202759,"text":"是否被ssdeep命中"},"children":[]},{"data":{"id":"bg1eb9ost4hs","created":1506479215897,"text":"是否被yara命中"},"children":[]}]},{"data":{"id":"bg1e21g932tc","created":1506478492689,"text":"是否采用了代理，代理的网络行为"},"children":[]},{"data":{"id":"bg1e556zyxa8","created":1506478735929,"text":"跃迁节点"},"children":[]},{"data":{"id":"bg1e58hvk0zk","created":1506478743117,"text":"是否DNS在已知的DGA僵尸网络中"},"children":[]}]}]},"template":"default","theme":"fresh-blue","version":"1.4.43"}